<Window
    x:Class="ChristmasThing.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:christmasthing="clr-namespace:ChristmasThing"
    xmlns:componentmodel="clr-namespace:System.ComponentModel;assembly=WindowsBase"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="MainWindow"
    Width="1000"
    Height="650"
    mc:Ignorable="d">
    <Window.DataContext>
        <christmasthing:MainWindowViewModel />
    </Window.DataContext>
    <Window.Resources>
        <CollectionViewSource x:Key="NewSecretSantaExchangesKey" Source="{Binding NewSecretSantaExchanges}">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription PropertyName="Id" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <CollectionViewSource x:Key="AvailableSignificantOthersKey" Source="{Binding AvailableSignificantOthers}">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <CollectionViewSource x:Key="ParticipantsKey" Source="{Binding Participants}">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <CollectionViewSource x:Key="AvailableGiftExchangeYearsKey" Source="{Binding AvailableGiftExchangeYears}">
            <CollectionViewSource.SortDescriptions>
                <componentmodel:SortDescription Direction="Descending" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>
    </Window.Resources>
    <TabControl>
        <TabItem Header="Participants">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="5" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <GroupBox
                    Grid.Row="0"
                    Grid.Column="0"
                    Header="New Participant">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="5" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="5" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="5" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Label
                            Grid.Row="0"
                            Grid.Column="0"
                            Content="Name" />
                        <TextBox
                            Grid.Row="0"
                            Grid.Column="2"
                            MinWidth="200"
                            Text="{Binding NewParticipantName, UpdateSourceTrigger=PropertyChanged}" />

                        <Label
                            Grid.Row="2"
                            Grid.Column="0"
                            Content="Significant Other" />
                        <ComboBox
                            Grid.Row="2"
                            Grid.Column="2"
                            DisplayMemberPath="Name"
                            ItemsSource="{Binding Source={StaticResource AvailableSignificantOthersKey}}"
                            SelectedValue="{Binding NewParticipantSignificantOther}" />

                        <Button
                            Grid.Row="4"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Height="30"
                            Command="{Binding AddNewParticipantCommand}"
                            Content="Add New Participant" />
                    </Grid>
                </GroupBox>
                <GroupBox
                    Grid.Row="3"
                    Grid.Column="0"
                    Header="Edit Participant">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="5" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="5" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="5" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="5" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Label
                            Grid.Row="0"
                            Grid.Column="0"
                            Content="Select Participant" />
                        <ComboBox
                            Grid.Row="0"
                            Grid.Column="2"
                            DisplayMemberPath="Name"
                            ItemsSource="{Binding Source={StaticResource ParticipantsKey}}"
                            SelectedValue="{Binding SelectedParticipantToEdit}" />

                        <Label
                            Grid.Row="2"
                            Grid.Column="0"
                            Content="Edit Name" />
                        <TextBox
                            Grid.Row="2"
                            Grid.Column="2"
                            MinWidth="200"
                            Text="{Binding SelectedParticipantToEditNewName, UpdateSourceTrigger=PropertyChanged}" />

                        <Label
                            Grid.Row="4"
                            Grid.Column="0"
                            Content="Edit Significant Other" />
                        <ComboBox
                            Grid.Row="4"
                            Grid.Column="2"
                            DisplayMemberPath="Name"
                            ItemsSource="{Binding Source={StaticResource AvailableSignificantOthersKey}}"
                            SelectedValue="{Binding SelectedParticipantToEditNewSigOther}" />

                        <Button
                            Grid.Row="6"
                            Grid.Column="0"
                            Grid.ColumnSpan="3"
                            Height="30"
                            Command="{Binding SaveEditedParticipantCommand}"
                            Content="Save Edited Participant" />
                    </Grid>
                </GroupBox>
            </Grid>
        </TabItem>
        <TabItem Header="New Exchange">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="5" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="5" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <ListBox
                    Grid.Row="0"
                    Grid.Column="0"
                    DisplayMemberPath="Name"
                    ItemsSource="{Binding Source={StaticResource ParticipantsKey}}"
                    SelectionChanged="ListBox_SelectionChanged"
                    SelectionMode="Multiple" />

                <ScrollViewer
                    Grid.Row="0"
                    Grid.RowSpan="5"
                    Grid.Column="2">
                    <ListView
                        DisplayMemberPath="Id"
                        ItemsSource="{Binding Source={StaticResource NewSecretSantaExchangesKey}}"
                        SelectedItem="{Binding SelectedSecretSantaExchange}" />
                </ScrollViewer>

                <TextBox
                    Grid.Row="0"
                    Grid.Column="4"
                    IsReadOnly="True"
                    Text="{Binding SelectedSecretSantaExchange.DisplayText, Mode=OneWay}" />

                <Button
                    Grid.Row="2"
                    Grid.Column="0"
                    Height="30"
                    VerticalAlignment="Top"
                    Command="{Binding CreateNewGiftExchangeCommand}"
                    Content="Create New Gift Exchange" />

                <ContentControl
                    Grid.Row="2"
                    Grid.RowSpan="3"
                    Grid.Column="4"
                    Content="{Binding NewGiftExchangeCanvas}" />

                <Button
                    Grid.Row="4"
                    Grid.Column="0"
                    Height="30"
                    VerticalAlignment="Top"
                    Command="{Binding SaveNewGiftExchangeCommand}"
                    Content="Save Gift Exchange" />
            </Grid>
        </TabItem>
        <TabItem Header="Previous Exchanges">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <ListView
                    Grid.Column="0"
                    ItemsSource="{Binding Source={StaticResource AvailableGiftExchangeYearsKey}}"
                    SelectedItem="{Binding SelectedHistoricalGiftExchangeYear}" />
                <ContentControl Grid.Column="2" Content="{Binding HistoricalGiftExchangeCanvas}" />
            </Grid>
        </TabItem>
    </TabControl>
</Window>